=== Kashiwazaki SEO Perfect Breadcrumbs ===
Contributors: tsuyoshikashiwazaki
Tags: breadcrumbs, seo, navigation, schema.org, structured data, パンくずリスト, 構造化データ
Requires at least: 5.0
Tested up to: 6.4
Stable tag: 1.0.4
Requires PHP: 7.2
License: GPLv2 or later
License URI: https://www.gnu.org/licenses/gpl-2.0.html

革新的なURL構造解析でパンくずを自動生成！WordPressの階層に依存せず、実際のURL構造から正確な階層を構築する次世代パンくずリストプラグイン。

== Description ==

**革新的なURL構造解析エンジン搭載** - 従来のWordPressパンくずプラグインとは一線を画す、URL構造をベースにした階層解析システムを実装。

= 🎯 最大の特徴: URL構造ベースの階層解析 =

従来のパンくずプラグインは、WordPressの投稿階層やカテゴリー構造に依存していました。しかし、実際のサイトではURLと内部構造が一致しないことが多く、ユーザーが期待する階層とは異なるパンくずが表示される問題がありました。

**本プラグインの革新的アプローチ:**
* **実際のURL構造を解析** - `/company/about/team/` → 会社情報 > 会社概要 > チーム
* **WordPressの階層に依存しない** - 固定ページの親子関係に縛られない
* **直感的な階層表示** - URLパスがそのままユーザーが理解しやすい階層に
* **複雑なサイト構造に対応** - カスタム投稿タイプ、タクソノミー、サブディレクトリも完璧に解析
* **外部ディレクトリも認識** - WordPress外のディレクトリも階層に含められる

= 🚀 主要機能 =

**1. インテリジェントURL解析**
* URLパスから自動的に階層構造を構築
* 各階層のタイトルを自動取得（スクレイピング機能）
* サブディレクトリインストールでも正確に動作
* 最大10階層まで対応（無限ループ防止）

**2. 高度なエラー処理**
* 404エラーを自動検出して代替URLを使用
* 301/302リダイレクトを自動追跡
* 存在しないページは自動的にスキップ

**3. 完全なSEO対応**
* Schema.org構造化データ（JSON-LD）の自動生成
* Google検索結果でのリッチスニペット表示対応
* 検索エンジンのクローラビリティ向上
* URL構造とパンくずの一致によるSEO効果最大化

**4. 柔軟な表示制御**
* 投稿タイプごとの表示制御
* 自動挿入機能（上部/下部/両方）
* ショートコード対応 `[kspb_breadcrumbs]`
* テーマファイル用関数 `kspb_display_breadcrumbs()`

**5. デザイン・カスタマイズ**
* 3種類のデザインパターン（クラシック、モダン、角丸）
* カスタマイズ可能なフォントサイズ（10px〜24px）
* SVGアイコン付きの視覚的な表示
* レスポンシブデザイン完全対応

= ⭐ 活用例：URL構造ベースの威力 =

**例1: ECサイトの商品ページ**
```
URL: /shop/mens/clothing/shirts/casual/
生成: ショップ > メンズ > 衣類 > シャツ > カジュアル
（カテゴリー設定不要で自動生成）
```

**例2: コーポレートサイトの深い階層**
```
URL: /company/group/subsidiaries/tokyo-branch/
生成: 会社情報 > グループ会社 > 子会社一覧 > 東京支社
（固定ページの親子関係を設定せずに実現）
```

**例3: 外部システムとの統合**
```
URL: /portal/members/dashboard/
生成: ポータル > メンバー > ダッシュボード
（WordPress外のディレクトリも認識）
```

= ⚡ なぜURL構造ベースが優れているのか？ =

**従来の問題点:**
* 固定ページの親子関係とURLが一致しない
* カテゴリー構造と実際のサイト階層が異なる
* カスタム投稿タイプの階層が正しく表示されない
* 外部ディレクトリやランディングページが階層に含まれない

**本プラグインの解決策:**
実際のURL構造を解析することで、ユーザーが直感的に理解できる、サイトの実際の階層構造を正確に表現します。

= 💡 最適な使用シーン =

* **複雑なURL構造のサイト**: `/services/web-design/portfolio/` のような深い階層を正確に表現
* **カスタム投稿タイプ中心のサイト**: WordPressの内部構造に関係なくURL通りの階層を表示
* **ランディングページ多用サイト**: WordPress外のディレクトリも含めて統一的なパンくず表示
* **サブディレクトリインストール**: `/blog/` や `/shop/` などのサブディレクトリでも正確に動作
* **多言語サイト**: `/en/about/` や `/ja/about/` のような言語別URLでも適切に階層化

== Installation ==

= 自動インストール =

1. WordPress管理画面にログイン
2. 「プラグイン」→「新規追加」を選択
3. 「Kashiwazaki SEO Perfect Breadcrumbs」を検索
4. 「今すぐインストール」→「有効化」をクリック

= 手動インストール =

1. プラグインファイルをダウンロード
2. `kashiwazaki-seo-breadcrumbs`フォルダを`/wp-content/plugins/`ディレクトリにアップロード
3. WordPress管理画面の「プラグイン」メニューから有効化

= 初期設定 =

1. 管理画面の「Kashiwazaki SEO Perfect Breadcrumbs」メニューを開く
2. 表示したい投稿タイプを選択
3. デザインパターンを選択
4. 必要に応じてその他の設定をカスタマイズ
5. 「変更を保存」をクリック

= 使用方法 =

**方法1: 自動挿入（推奨）**
設定画面で投稿タイプを選択するだけで自動的に表示されます。

**方法2: テーマファイルに追加**
```php
<?php 
if (function_exists('kspb_display_breadcrumbs')) {
    kspb_display_breadcrumbs();
} 
?>
```

**方法3: ショートコード**
```
[kspb_breadcrumbs]
```

**方法4: ウィジェット対応（予定）**
今後のアップデートで対応予定

== Frequently Asked Questions ==

= パンくずリストが表示されません =

以下を確認してください：
1. 設定画面で表示したい投稿タイプにチェックが入っているか
2. テーマファイルに `<?php kspb_display_breadcrumbs(); ?>` を追加したか
3. ショートコード `[kspb_breadcrumbs]` を正しく記述したか
4. 自動挿入を使用する場合、the_contentフィルターが有効か

= 404エラー回避機能とは何ですか？ =

URLステータスチェック機能を有効にすると、パンくずリストの各項目のURLが有効かチェックし、404エラーの場合は自動的に代替URLを使用します。これにより常に有効なリンクが表示されます。

= キャッシュをクリアする方法は？ =

設定画面の「URLスクレイピング機能」セクションにある「キャッシュをクリア」ボタンをクリックしてください。URLチェック結果とタイトル取得結果のキャッシュがすべて削除されます。

= カスタム投稿タイプに対応していますか？ =

はい、すべてのカスタム投稿タイプに対応しています。設定画面で表示したい投稿タイプを選択できます。

= アーカイブページでも使用できますか？ =

はい、カテゴリー、タグ、日付、著者などすべてのアーカイブページで使用可能です。テーマファイルに関数を追加してください。

= 構造化データは自動で追加されますか？ =

はい、Schema.orgのBreadcrumbList形式で自動的に構造化データが追加されます。Google Search Consoleの構造化データテストツールで確認できます。

= サブディレクトリインストールでも動作しますか？ =

はい、サブディレクトリインストールに完全対応しています。URLパスを正確に解析し、適切な階層構造を生成します。

= パフォーマンスへの影響は？ =

URLチェック結果を24時間キャッシュすることで、パフォーマンスへの影響を最小限に抑えています。また、スクレイピング機能は無効にすることも可能です。

== Screenshots ==

1. 管理画面 - 基本設定
2. クラシックデザインの表示例
3. モダンデザインの表示例
4. 角丸デザインの表示例
5. 構造化データの出力例
6. URLステータスチェック機能

== Changelog ==

= 1.0.2 =
* アーカイブページ表示制御機能を追加
* カスタム投稿タイプアーカイブの個別制御を追加
* 「すべてのページで表示」シンプルモードを追加（デフォルトON）
* 詳細設定の折りたたみUIを追加
* セクションごとの一括選択/解除ボタンを追加
* グリッドレイアウトで管理画面を改善
* カスタム投稿タイプアーカイブと個別投稿を分離
* イレギュラーなカスタムアーカイブページ（poll/datasets等）に対応
* 構造化データ出力に設定チェックを追加
* ショートコード・テーマ関数に設定チェックを追加
* 構造化データ出力をHTMLコメントで識別可能に

= 1.0.1 =
* サブディレクトリインストール時のURL構造解析を修正
* ホームURLがドメインルートを正しく指すように修正
* WordPressインストールディレクトリもパンくず階層に含めるよう改善
* URL構造の完全な解析により正確な階層表示を実現

= 1.0.0 =
* **革新的機能: URL構造ベースの階層解析エンジン実装**
* URLパスから自動的に階層構造を構築
* 各階層のタイトルを自動取得（スクレイピング機能）
* WordPress内部構造に依存しない独立した階層生成
* 404エラー自動回避機能
* Schema.org構造化データ対応（JSON-LD形式）
* 3種類のデザインパターン（クラシック、モダン、角丸）
* 自動挿入機能（上部/下部/両方）
* ショートコード対応
* 24時間キャッシュ機能
* サブディレクトリインストール完全対応
* 外部ディレクトリ認識機能
* 301/302リダイレクト対応
* 無限ループ防止機能（最大10階層）
* SVGアイコン表示
* レスポンシブデザイン対応
* 日本語完全対応

== Upgrade Notice ==

= 1.0.2 =
アーカイブページの表示制御機能を追加。管理画面UIを大幅に改善し、「すべてのページで表示」のシンプルモードを実装しました。

= 1.0.1 =
サブディレクトリインストール時のURL構造解析を修正しました。より正確な階層表示が可能になります。

= 1.0.0 =
初回リリース。安定版としてご利用いただけます。

== 技術仕様 ==

= 必要環境 =
* WordPress 5.0以上
* PHP 7.2以上
* MySQL 5.6以上

= 対応ブラウザ =
* Chrome（最新版）
* Firefox（最新版）
* Safari（最新版）
* Edge（最新版）

= 主な設定項目 =

**表示設定**
* 表示位置（上部・下部・両方）
* 表示する投稿タイプの選択
* フロントページでの表示
* ホームリンクの表示/非表示
* ホームテキストのカスタマイズ
* 区切り文字の変更

**デザイン設定**
* デザインパターン（クラシック・モダン・角丸）
* フォントサイズ（10px〜24px）
* SVGアイコンの自動表示

**機能設定**
* URLスクレイピング機能の有効/無効
* キャッシュクリア機能
* 404エラー自動回避
* リダイレクト追跡

= APIとフック =

**使用可能な関数:**
* `kspb_display_breadcrumbs()` - パンくずリストを表示

**クラス:**
* `KashiwazakiSeoPerfectBreadcrumbs` - メインプラグインクラス
* `KSPB_Breadcrumb_Builder` - パンくずリスト構築クラス
* `KSPB_Renderer` - レンダリングクラス
* `KSPB_URL_Scraper` - URLスクレイピングクラス

== サポート ==

* 公式サイト: https://www.tsuyoshikashiwazaki.jp
* サポートフォーラム: WordPress.orgのサポートフォーラムをご利用ください
* バグ報告: サポートフォーラムまたは公式サイトまで

== クレジット ==

開発者: 柏崎剛 (Tsuyoshi Kashiwazaki)
* Website: https://www.tsuyoshikashiwazaki.jp
* Profile: https://www.tsuyoshikashiwazaki.jp/profile/

== ライセンス ==

このプラグインはGPL v2またはそれ以降のバージョンでライセンスされています。 